# Tarea 7
## Enunciado
<h3>API REST</h3>
<p>
   En esta tarea añadiremos una API REST a nuestra aplicación, siguiendo el tutorial de la página
   <a href="https://medium.com/@vasjaforutube/django-mongodb-django-rest-framework-mongoengine-ee4eb5857b9a">Django + MongoDB = Django REST Framework Mongoengine</a>,
   y la documentación de <a href="https://github.com/umutbozkurt/django-rest-framework-mongoengine">Django Rest Framework Mongoengine</a>
</p>

<br />
<div class="highlight"><pre><code class="language-bash" data-lang="bash">$ pip install djangorestframework
$ pip install django-rest-framework-mongoengine
</code></pre></div>
<br />
y las añadimos a <b>settings.py</b>
<pre>
<code class="language-python" data-lang="python"><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">(</span>
  <span class="s">...</span><span class="p">,</span>
  <span class="s">'registration'</span><span class="p">,</span>
  <span class="s">'rest_framework'</span><span class="p">,</span>
  <span class="s">'rest_framework_mongoengine'</span><span class="p">,</span>
  <span class="s">'restaurantes'</span><span class="p">,</span>
<span class="p">)</span></code>
</pre>
<br />

y hacemos un nuevo archivo <b>serializers.py</b> para el API, más o menos:
<pre><code class="language-python" data-lang="python">   from rest_framework_mongoengine import serializers
   from rest_framework_mongoengine import viewsets

   from .models import restaurants

   class restaurantsSerializer(serializers.DocumentSerializer):

       class Meta:
           model = restaurants
           fields = ('name', 'cuisine', 'borough', 'address', 'image')


   class restaurantsViewSet(viewsets.ModelViewSet):
       lookup_field = 'name'
       serializer_class = restaurantsSerializer

       def get_queryset(self):
           return restaurants.objects.all()

</code></pre>

<br />
y nos fañtaría añadir las rutas para el API en <b>urls.py</b>
<pre><code class="language-python" data-lang="python">   from rest_framework_mongoengine import routers

   from . import views
   from . import serializers

   # this is DRF router for REST API viewsets
   router = routers.DefaultRouter()

   # register REST API endpoints with DRF router
   router.register(r'restaurants', serializers.restaurantsViewSet, r"restaurants")


   urlpatterns = [
            ...
              # REST API root view (generated by DRF router)
              url(r'^api/', include(router.urls, namespace='api')),

   ]
</code></pre>

## Uso
#### Preparación del entorno
Lo primero será instalar MongoDB siguiendo las siguientes [instrucciones](https://docs.mongodb.com/getting-started/shell/installation/) si aún no lo hemos hecho, tras esto hay que [importar la base de datos de prueba](https://docs.mongodb.com/getting-started/python/import-data/)

```
virtualenv -p python3 <Directorio> # Directorio donde se desee desplegar
cd <Directorio>
source /bin/activate # Activa el entorno virtual
pip install -r requirements.txt # Instala mongoengine, Django y debería instalar las dependencias que se pueden ver abajo

```

#### Ejecución
```
python <Directorio>/app/manage.py runserver
```

## Dependencias
- Python==3.4.2
- Django==1.10.6
- Pillow==4.0.0
- django-registration-redux==1.6
- django-rest-framework-mongoengine==3.3.1
- djangorestframework==3.6.3
- mongoengine==0.11.0
- olefile==0.44
- pymongo==3.4.0
- six==1.10.0
